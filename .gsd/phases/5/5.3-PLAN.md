---
phase: 5
plan: 3
wave: 3
---

# Plan 5.3: Postulante Form & Document Management

## Objective
Implement complex form layout dividing applicant data logically (Personal Info, Studies, Interview Data, Portal). Include a dedicated section for file uploading, listing, and downloading.

## Context
- `web/src/pages/PostulanteDetail.jsx`
- `web/src/services/postulante.service.js`
- `api/models/Postulante.js` (for schema structure reference)

## Tasks

<task type="auto">
  <name>Postulante Details Form</name>
  <files>
    - web/src/pages/PostulanteDetail.jsx
    - web/src/components/forms/PersonalInfo.jsx
    - web/src/components/forms/InterviewInfo.jsx
    - web/src/components/forms/StudiesInfo.jsx
    - web/src/App.jsx
  </files>
  <action>
    - Create `PostulanteDetail.jsx`. It handles "Create" (if `id === 'new'`) and "Edit" (fetch `getById`). Use `react-router-dom` `useParams`.
    - Map route in `App.jsx` (`/postulantes/:id`).
    - Build form sections to avoid massive unreadable files (components taking `formData` & `onChange`).
    - Personal Info: `apellido`, `nombre`, `dni` (requires uniqueness check logic handled by UI on error), `edad`, `provincia`, `genero`, `estadoCivil`, `nacionalidad`, `telefono`, `mail`.
    - Studies & Professional: `puesto` (select), `tituloPrincipal` (select), `secundario` (string), `observaciones` (textarea).
    - Interview Data: `fechaEntrevista` (date), `asistenciaEntrevista` (bool), `estadoEntrevista` (select), `estadoContacto` (select), `resultadoEntrevista` (text), `resultadoFinal` (text).
    - Origin: `portalBusqueda` (select), `referenciaBusqueda` (text).
    - Form submission saves data (`postulanteService.create/update`) and redirects/shows success toast.
  </action>
  <verify>grep "PersonalInfo" web/src/pages/PostulanteDetail.jsx</verify>
  <done>Full 20-field form is componentized, handles errors, and posts safely.</done>
</task>

<task type="auto">
  <name>File Management UI</name>
  <files>
    - web/src/components/FileManager.jsx
    - web/src/pages/PostulanteDetail.jsx
  </files>
  <action>
    - Only shown in "Edit" mode (when `id !== 'new'`).
    - Component `FileManager.jsx` accepting `postulanteId` as prop.
    - Mount `useEffect` fetching `postulanteService.listFiles(postulanteId)`.
    - List files with a download button triggering blob download.
    - Add an `<input type="file" />` and upload button triggering `postulanteService.uploadFile(id, file)`.
  </action>
  <verify>grep "FileManager" web/src/pages/PostulanteDetail.jsx</verify>
  <done>Applicant documents are interactable from their detail profile view.</done>
</task>

## Success Criteria
- [ ] Extensive Applicant Form is split, responsive, and fully mapped to Mongoose schemas.
- [ ] New applicants can be created without crashing on mandatory constraints.
- [ ] An existing applicant's detail sheet displays their documents.
- [ ] Users can safely upload and download the candidate CV (`.pdf`, `.docx`, etc.).
