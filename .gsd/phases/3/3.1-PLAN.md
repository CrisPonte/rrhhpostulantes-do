---
phase: 3
plan: 1
wave: 1
---

# Plan 3.1: Postulante Repository & CRUD

## Objective
Implement the Postulante repository and controller to handle the complex CRUD operations and advanced search filters (province, position, degree, etc.) required by the RFP.

## Context
- `.gsd/SPEC.md`
- `api/models/Postulante.js`
- `api/repositories/MongoRepository.js`

## Tasks

<task type="auto">
  <name>Postulante Repository implementation</name>
  <files>
    - api/repositories/PostulanteRepository.js
    - api/repositories/index.js
  </files>
  <action>
    - Create `PostulanteRepository.js` inheriting from `MongoRepository`.
    - Implement a specialized `findAll` or `search` method that accepts filters for: `provincia`, `puesto`, `tituloPrincipal`, `fechaEntrevista`, `resultadoEntrevista`, `estadoContacto`, `portalBusqueda`, etc.
    - Ensure logical search (partial match for strings if applicable).
    - Register the repository in `api/repositories/index.js`.
  </action>
  <verify>ls api/repositories/PostulanteRepository.js</verify>
  <done>Postulante repository is ready with advanced filtering logic.</done>
</task>

<task type="auto">
  <name>Postulante Controller & Routes</name>
  <files>
    - api/controllers/PostulanteController.js
    - api/routes/postulantes.routes.js
    - api/server.js
  </files>
  <action>
    - Create `PostulanteController.js`.
    - Implement CRUD methods: `getAll` (with query filters), `getById`, `create`, `update`, `delete` (soft/hard per role logic).
    - In `create` and `update`, ensure mandatory fields are validated.
    - Create `postulantes.routes.js`.
    - Protect routes with `verifyToken` and `checkRole`.
    - `admin` and `jefe de rrhh` can create/update. Only `admin` can hard delete. `staff` can only GET.
    - Mount routes in `server.js`.
  </action>
  <verify>grep "/api/postulantes" api/server.js</verify>
  <done>Postulante API endpoints are exposed and secured.</done>
</task>

## Success Criteria
- [ ] Advanced search filters are functional at the repository level.
- [ ] RBAC is correctly applied to Postulante routes.
- [ ] Postulante information can be persisted and retrieved via REST API.
