---
phase: 2
plan: 2
wave: 2
---

# Plan 2.2: Data Seeders

## Objective
Create a command-line execution script (`npm run seed`) capable of hydrating the database with base Roles, Users, Portales (Pandape, Linkedin, ManPower, Referenciado) and mapping Puestos and Títulos from the provided RFP specification to their respective Mongoose tables.

## Context
- `.gsd/SPEC.md`
- `.gsd/DECISIONS.md`
- `.gsd/ROADMAP.md`

## Tasks

<task type="auto">
  <name>Basic Roles & Users Seeder</name>
  <files>
    - api/package.json
    - api/scripts/seed.js
    - api/config/db.js
  </files>
  <action>
    - Add a `seed` script mapped to `node scripts/seed.js` inside `package.json`.
    - Create `api/scripts/seed.js` which connects to the database via `require('../config/db')`.
    - Drop collections for `Rol`, `Usuario` (warn before doing it via console output, or do upserts to be safe).
    - Insert 3 roles: `admin`, `jefe de rrhh`, `staff`.
    - Create 3 default users (one per role) using `bcrypt` encrypted `123456` or `password` explicitly logging their generated credentials via `console.log`. Give them basic random emails.
  </action>
  <verify>grep "node scripts/seed.js" api/package.json</verify>
  <done>`seed.js` script successfully creates users and roles.</done>
</task>

<task type="auto">
  <name>Support Data Seeder</name>
  <files>
    - api/scripts/seed.js
  </files>
  <action>
    - Expand `seed.js` to clear and pre-populate `Portal` (Pandape, Linkedin, ManPower, Referenciado).
    - Define an array containing a subset (or all) of the "Puestos" strings mentioned in the RFP, and upsert them into the `Puesto` collection.
    - Define an array containing a subset (or all) of the "Títulos" strings mentioned in the RFP, and upsert them into the `Titulo` collection.
    - Make sure the script closes the `mongoose` connection exactly after seeding is complete via `process.exit(0)`.
  </action>
  <verify>cat api/scripts/seed.js | grep "Linkedin"</verify>
  <done>Seed script contains logic to persist titles, job positions, and portals.</done>
</task>

## Success Criteria
- [ ] Running `npm run seed` connects, drops, inserts and closes without throwing errors.
- [ ] Default users are created successfully with a predefined simple password that bcrypt hashed.
- [ ] Portals match the RFP exactly.
